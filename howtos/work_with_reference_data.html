

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Working with reference data &mdash; KBase SDK 0.1.18 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Listing and viewing jobs" href="job_manager.html" />
    <link rel="prev" title="Manually building the SDK" href="manual_build.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> KBase SDK
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Intro</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Concepts and Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../video_tutorial.html">Video Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/dependencies.html">1. Dependencies &amp; Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/install.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/initialize.html">3. Initialize the Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/helloworld.html">4. Hello World Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/setup.html">5. ContigFilter Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/inputsoutputs.html">6. Narrative User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/implement.html">7. Implement Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/publish.html">8. Publish and Update</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references/questions_and_answers.html">Common Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_a_report.html">Creating reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="add_ui_elements.html">Adding UI Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="edit_your_dockerfile.html">Editing your app’s Dockerfile</a></li>
<li class="toctree-l1"><a class="reference internal" href="fill_out_app_information.html">Fully documenting your app</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_a_shell_command.html">Running shell commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_utils.html">Working with the file utils</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="workspace.html">Using Workspace Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual_build.html">Manually building the SDK</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Working with reference data</a></li>
<li class="toctree-l1"><a class="reference internal" href="job_manager.html">Listing and viewing jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic_services.html">Dynamic Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="update_to_py3.html">Updating a module to Python3</a></li>
</ul>
<p class="caption"><span class="caption-text">References &amp; Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references/module_anatomy.html">Anatomy of a Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/troubleshooting.html">Troubleshooting Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/dev_guidelines.html">Developer Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/KIDL_spec.html">KIDL Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/UI_spec.html">Narrative App UI Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/terminology.html">Terminology</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">KBase SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Working with reference data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/kbase/kb_sdk_docs/blob/blob/master/source/howtos/work_with_reference_data.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="working-with-reference-data">
<h1>Working with reference data<a class="headerlink" href="#working-with-reference-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="adding-reference-data-to-a-kbase-app">
<h2>Adding Reference Data to a KBase App<a class="headerlink" href="#adding-reference-data-to-a-kbase-app" title="Permalink to this headline">¶</a></h2>
<div class="topic">
<p class="topic-title first">Motivation</p>
<p>Some tools and applications make use of large reference data
collections. For example, a QC app may have a reference data with common
contaminants. Adding data such as this to the git repo for the module
can make it very large. In addition, the generated Docker image would
also be very large. KBase App reference data is designed to address this
scenario.</p>
</div>
<div class="topic">
<p class="topic-title first">How Reference Data Works</p>
<p>To minimize the image size, this feature works by saving reference data
in a special volume space and then making that volume available through
a read-only mount in /data at app execution time. An init mode for the
module is run at registration time to initialize the reference data
volume. In addition, the reference data is separately versioned, so
code-only updates to a module can be made without having to
re-initialize the reference data.</p>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>To make use of this feature, the app developer needs to do a few simple
things.</p>
<ol class="arabic simple">
<li>Add the data-version tag to the kbase.yaml file and give it a
semantic version tag.</li>
<li>Add any downloading and data preparation steps to the init section of
the entrypoint.sh script in the scripts directory. The init script
should place the data in /data and any apps that use the data should
be configured to look for the data in this location.</li>
<li>Create a __READY__ file in /data to indicate that the reference
data volume was successfully created. Ideally, some sanity tests
should be performed to confirm things ran correctly by testing for
the presence of expected files. If the __READY__ file is not
present, the registration will fail, and the reference data area will
be removed.</li>
</ol>
<p>You can see an example in the <a href="https://github.com/kbaseapps/RAST\_SDK/blob/a975436d9c0af4f772bd7235b467180860f64060/scripts/entrypoint.sh#L18-L28" target="_blank">RAST application  </a></p>
</div>
<div class="section" id="updating-reference-data">
<h2>Updating Reference Data<a class="headerlink" href="#updating-reference-data" title="Permalink to this headline">¶</a></h2>
<p>If a new version of reference data is required, the developer can
increase the version number for the reference data in kbase.yaml, make
any updates to the init section, and re-register the app. This will
trigger the registration to initialize the reference data for the new
data version. Older versions of the app will continue to use the
previous reference data specified in that versions kbase.yaml file. This
helps to ensure reproducibility.</p>
</div>
<div class="section" id="gotchas">
<h2>Gotchas<a class="headerlink" href="#gotchas" title="Permalink to this headline">¶</a></h2>
<p>There a few things to watch out for with reference data:</p>
<ul class="simple">
<li>The reference data area (/data) is mounted during initialization
(module registration) and during app execution and replaces /data
from the Docker image. Any modifications made by the Dockerfile to
this space will not be visible. Changes must be done in the init
block in entrypoint.sh.</li>
<li>The reference data is only writeable at registration time. This is to
ensure that the data is not accidentally changed during execution
which could break reproducibility. If the app requires the reference
data to be writeable when it executes, then you add code to the
execution that copies the data into the writeable work area prior to
running the underlying application.</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="job_manager.html" class="btn btn-neutral float-right" title="Listing and viewing jobs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="manual_build.html" class="btn btn-neutral" title="Manually building the SDK" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, KBase

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>